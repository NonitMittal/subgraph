specVersion: 0.0.4
description: OpenShelf-OpenDesk Subgraph
repository: https://github.com/OpenShelf-OpenDesk/subgraph
schema:
    file: ./schema.graphql
dataSources:
    - kind: ethereum/contract
      name: Publisher
      network: {network}
      source:
          address: "{ PublisherAddress }"
          abi: Publisher
          startBlock: {PublisherStartBlock}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - Book
              - Series
              - Edition
              - BookMetadata
              - SeriesMetadata
          abis:
              - name: Publisher
                file: ./abis/Publisher.json
          eventHandlers:
              - event: NewBookLaunched(uint256,indexed address,string,uint256,uint256,uint256,bool,indexed address)
                handler: handleNewBookLaunched
              - event: NewEditionLaunched(uint256,string,uint256,uint256,uint256,bool,indexed address)
                handler: handleNewEditionLaunched
              - event: NewSeriesCreated(uint256,string,indexed address)
                handler: handleNewSeriesCreated
              - event: AddedBookToSeries(uint256,uint256)
                handler: handleAddedBookToSeries
          file: ./mappings/Publisher.ts
    - kind: ethereum/contract
      name: Exchange
      network: {network}
      source:
          address: "{ ExchangeAddress }"
          abi: Exchange
          startBlock: {ExchangeStartBlock}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - Book
          abis:
              - name: Exchange
                file: ./abis/Exchange.json
          eventHandlers:
              - event: OfferMade()
                handler: handleOfferMade
              - event: OfferCancelled()
                handler: handleOfferCancelled
              - event: OfferAccepted()
                handler: handleOfferAccepted
          file: ./mappings/Exchange.ts
    - kind: ethereum/contract
      name: Profile
      network: {network}
      source:
          address: "{ ProfileAddress }"
          abi: Profile
          startBlock: {ProfileStartBlock}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - ReaderProfile
              - ContributorProfile
          abis:
              - name: Profile
                file: ./abis/Profile.json
          eventHandlers:
              - event: ReaderProfileUpdated(indexed address,string)
                handler: handleReaderProfileUpdated
              - event: ContributorProfileUpdated(indexed address,string)
                handler: handleContributorProfileUpdated
          file: ./mappings/Profile.ts
    - kind: ethereum/contract
      name: Rentor
      network: {network}
      source:
          address: "{ RentorAddress }"
          abi: Rentor
          startBlock: {RentorStartBlock}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - Book
          abis:
              - name: Rentor
                file: ./abis/Rentor.json
          eventHandlers:
              - event: AllBooksReturned()
                handler: handleAllBooksReturned
              - event: BookPutOnRent()
                handler: handleBookPutOnRent
              - event: BookRemovedFromRent()
                handler: handleBookRemovedFromRent
              - event: BookTakenOnRent()
                handler: handleBookTakenOnRent
              - event: BookReturned()
                handler: handleBookReturned
          file: ./mappings/Rentor.ts
templates:
    - name: Book
      kind: ethereum/contract
      network: {network}
      source:
          abi: Book
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          file: ./mappings/Book.ts
          entities:
              - Book
              - Edition
              - Copy
              - DistributedCopy
              - Contribution
          abis:
              - name: Edition
                file: ./abis/Edition.json
          eventHandlers:
              - event: BookBought(uint256,indexed address,uint256)
                handler: handleBookBought
              - event: BookTransferred(uint256,indexed address)
                handler: handleBookTransferred
              - event: PriceUpdated(uint256)
                handler: handlePriceUpdated
              - event: MarketSupplyIncreased(uint256)
                handler: handleMarketSupplyIncreased
              - event: SupplyUnlimited()
                handler: handleSupplyUnlimited
              - event: SupplyLimited()
                handler: handleSupplyLimited
              - event: RoyaltyUpdated(uint256)
                handler: handleRoyaltyUpdated
              - event: BookRedeemed(uint256,uint256,indexed address)
                handler: handleBookRedeemed
              - event: ContributorAdded(indexed address,uint96,string,uint256)
                handler: handleContributorAdded
              - event: RevenueWithdrawn(uint256)
                handler: handleRevenueWithdrawn
              - event: BookLocked(uint256,indexed address)
                handler: handleBookLocked
              - event: BookUnlocked(uint256)
                handler: handleBookUnlocked
features:
    - fullTextSearch
    - ipfsOnEthereumContracts
